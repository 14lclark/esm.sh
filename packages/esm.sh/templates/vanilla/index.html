<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>esm.sh/hot</title>
  <script type="importmap">
    {
      "imports": {
        "hot": "http://localhost:8080/v135/hot?plugins=use-state"
      }
    }
  </script>
  <script type="contentmap">
    {
      "contents": {
        "val:{name}": {
          "url": "https://api.val.town/v1/run/ije.${params.name}",
          "token": "${env.valtown}",
          "cacheTtl": 60
        }
      }
    }
  </script>
</head>

<body>
  <use-content src="val:myInfo" mapKey="url"></use-content>
  <use-content src="val:myInfo" mapKey="html" live="3" html></use-content>

  <use-content src="val:myInfo" store>
    <use-state>{url}</use-state>
  </use-content>

  <use-state>
    <p>
      themeColor:
      <input name="themeColor" type="text" />
      <button onclick="themeColor = 'red'">R</button>
      <button onclick="themeColor = 'green'">G</button>
      <button onclick="themeColor = 'blue'">B</button>
    </p>
  </use-state>

  <use-state init="{ show: false, msg: 'Hello world' }">
    <input name="msg" type="text" />
    <button onclick="msg = 'Hello world'">Reset</button>
    <button onclick="show = !show">
      {show ? "Hide" : "Show"}
    </button>
    <p>
      {msg}!
    </p>
    <p>
      show:
      <input name="show" type="checkbox" /><code style="color: gray;">{show.toString()}</code>
    </p>
    <p>
      themeColor: <code class="color-{themeColor}" style="color: state(themeColor)">{themeColor}</code>
    </p>

    <blockquote>
      <use-state init="{ msg: 'nesting' }">
        <input name="msg" type="text" />
        <button onclick="msg = 'nesting'">Reset</button>
        <p>
          {msg}!
        </p>
        <p>
          show: <code style="color: gray;">
            <span !show>Hide</span>
            <span show>Show</span>
          </code>
        </p>
        <p>
          themeColor: <code class="color-{themeColor}" style="color: state(themeColor)">{themeColor}</code>
        </p>
      </use-state>

      <use-state init="{
        select: 'foo',
        options: ['foo','bar','baz','qux'],
        progress: 50,
        ratio: 'foo'
      }">
        <select name="select">
          <option for="val of options" value="{val}">{val}</option>
        </select>
        <input name="progress" type="range" min="0" max="100" />
        <input name="ratio" type="radio" value="foo" /> Foo
        <input name="ratio" type="radio" value="bar" /> Bar
        <p>
          select: <code style="color: gray;">{select}</code>
        </p>
        <p>
          ratio: <code style="color: gray;">{ratio}</code>
        </p>
        <p>
          progress: <code style="color: gray;">{progress}</code>
        </p>
      </use-state>
    </blockquote>
  </use-state>

  <use-state init="{
      todos: [],
      todo: '',
      addTodo() {
        this.todos.push({ id: Date.now(), content: this.todo, done: false });
        this.todo = '';
      },
      sortTodo() {
        this.todos.sort((a, b) => a.content.localeCompare(b.content));
      }
    }">
    <p>
      <input id="toFocus" name="todo" type="text" placeholder="Type something..." onkeydown.enter="addTodo()" />
      <button onclick="addTodo(); toFocus.focus()" disabled="{!todo}">Add</button>
      <button onclick="sortTodo()" disabled="{todos.length<2}">Sort</button>
      <span>{todos.length}</span>
    </p>
    <ul>
      <li for="(todo,idx) of todos" key="{todo.id}">
        {idx}.
        <use-state with="todo">
          <input name="done" type="checkbox" />
          <span style="font-weight: 600;" +style="{done && 'text-decoration: line-through;color:gray'}">{content}</span>
        </use-state>
        <button onclick="todos.splice(idx, 1)">X</button>
      </li>
    </ul>
  </use-state>

  <script type="module">
    import hot from "hot"
    hot.state({ themeColor: "teal" })
    hot.fire()
  </script>
</body>

</html>
