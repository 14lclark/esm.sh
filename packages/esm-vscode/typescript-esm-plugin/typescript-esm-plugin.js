var yt=Object.create;var B=Object.defineProperty;var mt=Object.getOwnPropertyDescriptor;var vt=Object.getOwnPropertyNames;var gt=Object.getPrototypeOf,bt=Object.prototype.hasOwnProperty;var wt=(e,t)=>()=>(e&&(t=e(e=0)),t);var _t=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),_e=(e,t)=>{for(var r in t)B(e,r,{get:t[r],enumerable:!0})},xe=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of vt(t))!bt.call(e,i)&&i!==r&&B(e,i,{get:()=>t[i],enumerable:!(n=mt(t,i))||n.enumerable});return e};var Se=(e,t,r)=>(r=e!=null?yt(gt(e)):{},xe(t||!e||!e.__esModule?B(r,"default",{value:e,enumerable:!0}):r,e)),Oe=e=>xe(B({},"__esModule",{value:!0}),e);var $e={};_e($e,{__addDisposableResource:()=>Je,__assign:()=>X,__asyncDelegator:()=>Le,__asyncGenerator:()=>Ne,__asyncValues:()=>Fe,__await:()=>K,__awaiter:()=>Ce,__classPrivateFieldGet:()=>qe,__classPrivateFieldIn:()=>Ge,__classPrivateFieldSet:()=>We,__createBinding:()=>Y,__decorate:()=>Me,__disposeResources:()=>Ve,__esDecorate:()=>xt,__exportStar:()=>Ae,__extends:()=>Te,__generator:()=>Ee,__importDefault:()=>Ue,__importStar:()=>Ke,__makeTemplateObject:()=>He,__metadata:()=>Pe,__param:()=>ke,__propKey:()=>Ot,__read:()=>le,__rest:()=>je,__runInitializers:()=>St,__setFunctionName:()=>Tt,__spread:()=>De,__spreadArray:()=>Ie,__spreadArrays:()=>Re,__values:()=>Q,default:()=>kt});function Te(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");se(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}function je(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Me(e,t,r,n){var i=arguments.length,a=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(o=e[c])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function ke(e,t){return function(r,n){t(r,n,e)}}function xt(e,t,r,n,i,a){function o(D){if(D!==void 0&&typeof D!="function")throw new TypeError("Function expected");return D}for(var c=n.kind,S=c==="getter"?"get":c==="setter"?"set":"value",u=!t&&e?n.static?e:e.prototype:null,m=t||(u?Object.getOwnPropertyDescriptor(u,n.name):{}),_,v=!1,p=r.length-1;p>=0;p--){var h={};for(var x in n)h[x]=x==="access"?{}:n[x];for(var x in n.access)h.access[x]=n.access[x];h.addInitializer=function(D){if(v)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(D||null))};var T=(0,r[p])(c==="accessor"?{get:m.get,set:m.set}:m[S],h);if(c==="accessor"){if(T===void 0)continue;if(T===null||typeof T!="object")throw new TypeError("Object expected");(_=o(T.get))&&(m.get=_),(_=o(T.set))&&(m.set=_),(_=o(T.init))&&i.unshift(_)}else(_=o(T))&&(c==="field"?i.unshift(_):m[S]=_)}u&&Object.defineProperty(u,n.name,m),v=!0}function St(e,t,r){for(var n=arguments.length>2,i=0;i<t.length;i++)r=n?t[i].call(e,r):t[i].call(e);return n?r:void 0}function Ot(e){return typeof e=="symbol"?e:"".concat(e)}function Tt(e,t,r){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:r?"".concat(r," ",t):t})}function Pe(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Ce(e,t,r,n){function i(a){return a instanceof r?a:new r(function(o){o(a)})}return new(r||(r=Promise))(function(a,o){function c(m){try{u(n.next(m))}catch(_){o(_)}}function S(m){try{u(n.throw(m))}catch(_){o(_)}}function u(m){m.done?a(m.value):i(m.value).then(c,S)}u((n=n.apply(e,t||[])).next())})}function Ee(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,o;return o={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function c(u){return function(m){return S([u,m])}}function S(u){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(r=0)),r;)try{if(n=1,i&&(a=u[0]&2?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,i=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){r.label=u[1];break}if(u[0]===6&&r.label<a[1]){r.label=a[1],a=u;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(u);break}a[2]&&r.ops.pop(),r.trys.pop();continue}u=t.call(e,r)}catch(m){u=[6,m],i=0}finally{n=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Ae(e,t){for(var r in e)r!=="default"&&!Object.prototype.hasOwnProperty.call(t,r)&&Y(t,e,r)}function Q(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function le(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,a=[],o;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(c){o={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(o)throw o.error}}return a}function De(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(le(arguments[t]));return e}function Re(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var a=arguments[t],o=0,c=a.length;o<c;o++,i++)n[i]=a[o];return n}function Ie(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function K(e){return this instanceof K?(this.v=e,this):new K(e)}function Ne(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,a=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(v){n[v]&&(i[v]=function(p){return new Promise(function(h,x){a.push([v,p,h,x])>1||c(v,p)})})}function c(v,p){try{S(n[v](p))}catch(h){_(a[0][3],h)}}function S(v){v.value instanceof K?Promise.resolve(v.value.v).then(u,m):_(a[0][2],v)}function u(v){c("next",v)}function m(v){c("throw",v)}function _(v,p){v(p),a.shift(),a.length&&c(a[0][0],a[0][1])}}function Le(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,a){t[i]=e[i]?function(o){return(r=!r)?{value:K(e[i](o)),done:!1}:a?a(o):o}:a}}function Fe(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Q=="function"?Q(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(a){r[a]=e[a]&&function(o){return new Promise(function(c,S){o=e[a](o),i(c,S,o.done,o.value)})}}function i(a,o,c,S){Promise.resolve(S).then(function(u){a({value:u,done:c})},o)}}function He(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Ke(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)r!=="default"&&Object.prototype.hasOwnProperty.call(e,r)&&Y(t,e,r);return jt(t,e),t}function Ue(e){return e&&e.__esModule?e:{default:e}}function qe(e,t,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof t=="function"?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(e):n?n.value:t.get(e)}function We(e,t,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof t=="function"?e!==t||!i:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(e,r):i?i.value=r:t.set(e,r),r}function Ge(e,t){if(t===null||typeof t!="object"&&typeof t!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof e=="function"?t===e:e.has(t)}function Je(e,t,r){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var n;if(r){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=t[Symbol.asyncDispose]}if(n===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=t[Symbol.dispose]}if(typeof n!="function")throw new TypeError("Object not disposable.");e.stack.push({value:t,dispose:n,async:r})}else r&&e.stack.push({async:!0});return t}function Ve(e){function t(n){e.error=e.hasError?new Mt(n,e.error,"An error was suppressed during disposal."):n,e.hasError=!0}function r(){for(;e.stack.length;){var n=e.stack.pop();try{var i=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(i).then(r,function(a){return t(a),r()})}catch(a){t(a)}}if(e.hasError)throw e.error}return r()}var se,X,Y,jt,Mt,kt,ze=wt(()=>{se=function(e,t){return se=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},se(e,t)};X=function(){return X=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},X.apply(this,arguments)};Y=Object.create?function(e,t,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(t,r);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,i)}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]};jt=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};Mt=typeof SuppressedError=="function"?SuppressedError:function(e,t,r){var n=new Error(r);return n.name="SuppressedError",n.error=e,n.suppressed=t,n};kt={__extends:Te,__assign:X,__rest:je,__decorate:Me,__param:ke,__metadata:Pe,__awaiter:Ce,__generator:Ee,__createBinding:Y,__exportStar:Ae,__values:Q,__read:le,__spread:De,__spreadArrays:Re,__spreadArray:Ie,__await:K,__asyncGenerator:Ne,__asyncDelegator:Le,__asyncValues:Fe,__makeTemplateObject:He,__importStar:Ke,__importDefault:Ue,__classPrivateFieldGet:qe,__classPrivateFieldSet:We,__classPrivateFieldIn:Ge,__addDisposableResource:Je,__disposeResources:Ve}});var lt=_t(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});var N=(ze(),Oe($e));O.SyntaxKind=void 0;(function(e){e.Text="Text",e.Tag="Tag"})(O.SyntaxKind||(O.SyntaxKind={}));var b,ne,Ye,d,g,pe,f,V,$,j;function de(e){return{lower:e.toLowerCase().split("").map(function(t){return t.charCodeAt(0)}),upper:e.toUpperCase().split("").map(function(t){return t.charCodeAt(0)}),length:e.length}}var Z=de("!doctype"),fe=de("style"),ue=de("script");function q(){return f===32||f===10||f===9||f===9||f===13||f===12}function Be(e){b=0,ne=e,Ye=e.length,d=0,g=0,pe=[],V=!1,$=!1,j=0}function Ze(e){for(Be(e);g<Ye;){switch(f=ne.charCodeAt(g),b){case 0:Pt();break;case 1:Ct();break;case 2:Et();break;case 3:et();break;case 4:At();break;case 5:Dt();break;case 6:Rt();break;case 7:It();break;case 8:Nt();break;case 9:Lt();break;case 10:Ft();break;case 11:Ht();break;case 12:Kt();break;case 13:Ut();break;case 14:qt();break;default:tt();break}g++}switch(b){case 0:case 1:case 4:case 5:case 6:case 7:case 11:case 12:case 13:s(0);break;case 2:s(1);break;case 3:break;case 8:s(1,12);break;case 9:g-d===Z.length?s(1):(s(1,void 0,d+1),s(0));break;case 10:g-d===2?s(1):(s(1,void 0,d+1),s(0));break;case 14:s(3);break}var t=pe;return Be(""),t}function s(e,t,r){t===void 0&&(t=b),r===void 0&&(r=g);var n=ne.substring(d,r);(e===1||e===3)&&(n=n.toLowerCase()),e===1&&(n==="script"?V=!0:n==="style"&&($=!0)),e===3&&(V=$=!1),(e===0||e===4)&&r===d||pe.push({type:e,start:d,end:r,value:n}),e===2||e===3?(d=r+1,b=0):(d=r,b=t)}function Pt(){f===60&&s(0,1)}function Ct(){if(V||$){f===47?(b=14,d=g+1):b=0;return}f>=97&&f<=122||f>=65&&f<=90?(b=2,d=g):f===47?(b=14,d=g+1):f===60?s(0):f===33?(b=8,d=g):f===63?(d=g,s(1,12)):b=0}function Et(){q()?s(1,3):f===62?(s(1),s(2)):f===47&&s(1,7)}function et(){f===62?(s(4),s(2)):f===47?s(4,7):f===61?(s(4),s(5,void 0,g+1)):f===39?s(4,5):f===34?s(4,6):q()||s(4,4)}function At(){f===62?(s(6),s(2)):f===47?s(6,7):f===61?(s(6),s(5,3,g+1)):q()&&s(6,3)}function Dt(){f===39&&s(7,3,g+1)}function Rt(){f===34&&s(8,3,g+1)}function It(){f===62?s(2):(s(6,3),et())}function Nt(){switch(f){case 45:b=10;break;case 100:case 68:b=9;break;default:s(1,12);break}}function Lt(){j=g-d,j===Z.length?q()?s(1,3):tt():f===62?(s(1,void 0,d+1),s(0),s(2)):Z.lower[j]!==f&&Z.upper[j]!==f&&s(1,12,d+1)}function Ft(){f===45?s(1,11,g+1):s(1,12,d+1)}function Ht(){f===45&&s(0,13)}function Kt(){f===62&&(s(0),s(2))}function Ut(){j=g-d,j===2?f===62?s(2):f===45?s(0,void 0,d+1):b=11:f!==45&&(b=11)}function qt(){j=g-d,$?f===60?(d-=2,s(0,1)):j<fe.length?fe.lower[j]!==f&&fe.upper[j]!==f&&(d-=2,b=0):f===62?s(3):q()||(d-=2,b=0):V?f===60?(d-=2,s(0,1)):j<ue.length?ue.lower[j]!==f&&ue.upper[j]!==f&&(d-=2,b=0):f===62?s(3):q()||(d-=2,b=0):f===62&&s(3)}function tt(){throw new SyntaxError('Unexpected token "'+ne.charAt(g)+'" at '+g+" when parse "+b)}function rt(e,t){return e.split(",").reduce(function(r,n){return r[n]=t,r},Object.create(null))}var nt=rt("area,base,br,col,embed,hr,img,input,link,meta,param,source,track,wbr,!doctype,,!,!--",!0),Wt=rt("li,option,select,textarea",!0);function Gt(e){return e.split(`
`).reduce(function(t,r){return t.push(r.length+1+t[t.length-1]),t},[0])}function Jt(e,t){for(var r=NaN,n=NaN,i=1;i<e.length;i++)if(e[i]>t){r=i,n=t-e[i-1]+1;break}return[r,n]}function it(e,t,r,n){if(n.enter&&n.enter(e,t,r),e.type===O.SyntaxKind.Tag&&Array.isArray(e.body))for(var i=0;i<e.body.length;i++)it(e.body[i],e,i,n);n.leave&&n.leave(e,t,r)}function at(e,t){for(var r=0;r<e.length;r++)it(e[r],void 0,r,t)}var A,U,F,M,he,l,C,W,ee,te;function Xe(e,t){e===void 0?(U=0,F.length=0,W=""):(F=Ze(e),U=F.length,W=e),A=0,M=void 0,he=[],l=void 0,C=void 0,ee=void 0,te=t}function ye(e){M?e.type===O.SyntaxKind.Tag&&e.name===M.tag.name&&Wt[e.name]?(M=M.parent,ye(e)):M.tag.body&&(M.tag.end=e.end,M.tag.body.push(e)):he.push(e)}function Vt(e){M={parent:M,tag:e},C=void 0}function G(e,t,r){return e===void 0&&(e=l.start),t===void 0&&(t=l.end),r===void 0&&(r=l.value),{start:e,end:t,value:r,type:O.SyntaxKind.Text}}function $t(){return{start:l.start-1,end:l.end,type:O.SyntaxKind.Tag,open:G(l.start-1),name:l.value,rawName:W.substring(l.start,l.end),attributes:[],attributeMap:void 0,body:null,close:null}}function Qe(){return{start:l.start,end:l.end,name:G(),value:void 0}}function zt(){return{start:l.start,end:l.end,value:l.type===6?l.value:l.value.substr(1,l.value.length-2),quote:l.type===6?void 0:l.type===7?"'":'"'}}function re(e){e===void 0&&(e=C),e.value+=l.value,e.end=l.end}function Bt(){ee===void 0&&(ee=Gt(W));var e=N.__read(Jt(ee,l.start),2),t=e[0],r=e[1];throw new Error('Unexpected token "'+l.value+"("+l.type+')" at ['+t+","+r+"]"+(M?" when parsing tag: "+JSON.stringify(M.tag.name)+".":""))}function Xt(e){var t,r;e.attributeMap={};try{for(var n=N.__values(e.attributes),i=n.next();!i.done;i=n.next()){var a=i.value;e.attributeMap[a.name.value]=a}}catch(o){t={error:o}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}}function Qt(){var e=0,t=void 0,r=$t();if(ye(r),r.name===""||r.name==="!"||r.name==="!--"){if(r.open.value="<"+r.open.value,A===U)return;if(l=F[++A],l.type!==2)for(C=G(),r.body=[C];++A<U;){if(l=F[A],l.type===2){C=void 0;break}re()}r.close=G(l.start,l.end+1,l.value+">"),r.end=r.close.end;return}for(;++A<U;)if(l=F[A],l.type===2){r.end=r.open.end=l.end+1,r.open.value=W.substring(r.open.start,r.open.end),l.value===""&&!nt[r.name]?(r.body=[],Vt(r)):r.body=void 0;break}else e===0?l.type!==4&&(t=Qe(),e=1,r.attributes.push(t)):e===1?l.type===4?e=2:l.type===5?e=3:re(t.name):e===2?l.type!==4&&(l.type===5?e=3:(t=Qe(),e=1,r.attributes.push(t))):e===3?l.type!==4&&(t.value=zt(),l.type===6?e=4:(t.end=t.value.end,e=0)):l.type===4?(t.end=t.value.end,e=0):re(t.value)}function Yt(){for(var e=M;!(!e||l.value.trim()===e.tag.name);)e=e.parent;e&&(e.tag.close=G(l.start-2,l.end+1,W.substring(l.start-2,l.end+1)),e.tag.end=e.tag.close.end,e=e.parent,M=e)}function ot(e,t){for(Xe(e,N.__assign({setAttributeMap:!1},t));A<U;){switch(l=F[A],l.type){case 0:C?re(C):(C=G(),ye(C));break;case 1:C=void 0,Qt();break;case 3:C=void 0,Yt();break;default:Bt();break}A++}var r=he;return te?.setAttributeMap&&at(r,{enter:function(n){n.type===O.SyntaxKind.Tag&&Xt(n)}}),Xe(),r}var ce={allowedTags:["a","abbr","address","area","article","aside","b","bdi","bdo","big","blockquote","br","button","caption","cite","code","col","colgroup","data","dd","del","dfn","div","dl","dt","em","figcaption","figure","footer","h1","h2","h3","h4","h5","h6","header","hgroup","hr","i","img","ins","kbd","label","li","main","map","ol","p","picture","pre","q","rp","rt","ruby","s","samp","section","small","span","strong","sub","summary","sup","table","tbody","td","tfoot","th","thead","time","tr","u","ul","var","wbr"],allowedAttrs:["style"],tagAllowedAttrs:{a:["href","target"],img:["src"],td:["rowspan","colspan"],th:["rowspan","colspan"],time:["datetime"],colgroup:["span"],col:["span"]},allowedUrl:/^(?:mailto|tel|https?|ftp|[^:]*[^a-z0-9.+-][^:]*):|^[^:]*$/i};function Zt(e,t){t===void 0&&(t={});var r=N.__assign(N.__assign(N.__assign({},ce),t),{tagAllowedAttrs:N.__assign(N.__assign({},ce.tagAllowedAttrs),t.tagAllowedAttrs)}),n=ot(e);return st(n,r,e)}function st(e,t,r){return e.map(function(n){if(n.type===O.SyntaxKind.Text)return n.value;if(t.allowedTags.indexOf(n.name)===-1)return"";if(nt[n.name]){if(n.body!==void 0)throw new Error('self closed tag "'+n.name+'" should not have body')}else if(!n.body||!n.close)throw new Error('tag "'+n.name+'" should have body and close');var i=n.attributes.filter(function(o){var c;return t.allowedAttrs.indexOf(o.name.value)>-1||((c=t.tagAllowedAttrs[n.name])===null||c===void 0?void 0:c.indexOf(o.name.value))>-1?!!(!o.value||o.name.value!=="src"&&o.name.value!=="href"||t.allowedUrl.test(o.value.value)):!1}).map(function(o){return r.substring(o.start,o.end)}).join(" "),a="<"+n.rawName+(i?" "+i:"")+">";return n.body?a+st(n.body,t,r)+("</"+n.rawName+">"):a}).join("")}O.parse=ot;O.safeHtml=Zt;O.safeHtmlDefaultOptions=ce;O.tokenize=Ze;O.walk=at});var nr={};_e(nr,{init:()=>rr});module.exports=Oe(nr);var ut=Se(require("typescript/lib/tsserverlibrary")),ct=require("node:crypto"),pt=require("node:os"),k=require("node:path"),w=require("node:fs");var J=Se(lt());function ft(e){let t={};return(0,J.walk)((0,J.parse)(e),{enter:r=>{r.type===J.SyntaxKind.Tag&&r.name==="script"&&r.body&&r.attributes.some(n=>n.name.value==="type"&&n.value?.value==="importmap")&&(t=JSON.parse(r.body.map(n=>n.value).join("")))}}),t}var me=class e{#i;#n={importMap:{}};#e=new Map;#t;#r=()=>{};static userAgent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36";constructor(t){this.#i=t}create(t){let{languageService:r,languageServiceHost:n,project:i}=t,a=i.getCurrentDirectory(),o=(0,pt.homedir)(),c=(0,k.join)(o,".cache/esm.sh"),S=(0,k.join)(c,"meta");(0,w.existsSync)(S)||(0,w.mkdirSync)(S,{recursive:!0}),this.#t={i:0,info(p,...h){let x=(0,k.join)(a,"typescript-esm-plugin.log");this.i===0&&(this.i=1,(0,w.writeFileSync)(x,"",{encoding:"utf8",flag:"w",mode:438}));let T=[p];h.length&&(T.push("---"),T.push(...h.map(D=>JSON.stringify(D,void 0,2))),T.push("---")),(0,w.writeFileSync)(x,T.join(`
`)+`

`,{encoding:"utf8",flag:"a+",mode:438})}},this.#r=()=>{i.refreshDiagnostics(),i.updateGraph(),r.getProgram()?.emit()};let u=(0,k.join)(a,"index.html");try{if((0,w.existsSync)(u)){let p=(0,w.readFileSync)(u,"utf-8"),h=ft(p);this.#t.info("importmap set in index.html",h),this.#a(h),this.#t.info("importmap",this.#n.importMap)}}catch{}let m=n.getCompilationSettings.bind(n);n.getCompilationSettings=()=>{let p=m(),h=this.#n.importMap?.jsxImportSource;return h&&(p.jsx=ut.default.JsxEmit.ReactJSX,p.jsxImportSource=h),p};let _=n.resolveTypeReferenceDirectiveReferences?.bind(n);_&&(n.resolveTypeReferenceDirectiveReferences=(p,h,...x)=>(this.#t.info("resolveTypeReferenceDirectiveReferences",p),_(p,h,...x)));let v=n.resolveModuleNameLiterals?.bind(n);if(v){let p=(h,x)=>({resolvedModule:{resolvedFileName:h,extension:x,resolvedUsingTsExtension:x===".d.ts"}});n.resolveModuleNameLiterals=(h,x,...T)=>v(h,x,...T).map((ve,ie)=>{if(ve.resolvedModule)return ve;this.#t.info("resolveModuleNameLiterals["+ie+"]: "+h[ie].text,{containingFile:x});let dt=h[ie].text,y=this.#o(dt);if(tr(y)){let ae=new URL(y);if(ae.hostname==="esm.sh"){let ge=y.endsWith(".d.ts");if(this.#e.has(y)){let E=this.#e.get(y);if(typeof E=="string"){if(E)return p((0,k.join)(c,E),".d.ts");if(ge)return p((0,k.join)(c,ae.pathname),".d.ts")}return p(y,".js")}if(ge){let E=(0,k.join)(c,ae.pathname);if((0,w.existsSync)(E))return this.#e.set(y,""),p(E,".d.ts");if(!this.#e.has(y)){let H=()=>{this.#e.delete(y)},R=()=>fetch(y).then(I=>I.ok?I.text():(I.body?.cancel(),Promise.reject(I.statusText))).then(I=>{let L=(0,k.dirname)(E);(0,w.existsSync)(L)||(0,w.mkdirSync)(L,{recursive:!0}),(0,w.writeFileSync)(E,I,"utf-8"),this.#e.set(y,""),this.#r(),this.#t.info("dts loaded: "+y)});this.#e.set(y,R().catch(H))}}else{let E=(0,ct.createHash)("sha256").update(y).digest("hex"),H=(0,k.join)(S,E);if((0,w.existsSync)(H)){let R=JSON.parse((0,w.readFileSync)(H,"utf-8"));return R.dts?(this.#e.set(y,R.dts),p((0,k.join)(c,R.dts),".d.ts")):(this.#e.set(y,""),p(y,".js"))}else if(!this.#e.has(y)){let R=()=>{this.#e.delete(y)},I=async()=>{let L=await fetch(y,{method:"HEAD",headers:{"user-agent":e.userAgent}}).then(P=>(P.body?.cancel(),P.ok?P.headers.get("x-typescript-types")??"":Promise.reject(P.statusText))).catch(()=>(R(),null));L?(this.#t.info("dts found: "+L),fetch(L).then(P=>P.ok?P.text().then(oe=>[P.url,oe]):(P.body?.cancel(),Promise.reject(P.statusText))).then(([P,oe])=>{let z=new URL(P),be=(0,k.join)(c,z.pathname),we=(0,k.dirname)(be),ht=JSON.stringify({dts:z.pathname});(0,w.existsSync)(we)||(0,w.mkdirSync)(we,{recursive:!0}),(0,w.writeFileSync)(be,oe,"utf-8"),(0,w.writeFileSync)(H,ht,"utf-8"),this.#e.set(y,z.pathname),this.#r(),this.#t.info("dts loaded: "+y+" -> "+z.href)}).catch(R)):L===""&&((0,w.writeFileSync)(H,"{}","utf-8"),this.#e.set(y,""),this.#r())};this.#e.set(y,I())}}}return p(y,".js")}return{resolvedModule:void 0}})}return this.#t.info("plugin created, typescrpt v"+this.#i.version),r}onConfigurationChanged(t){this.#t.info("onConfigurationChanged",t),this.#a(t.importMap),this.#r()}#o(t){let{importMap:r}=this.#n,n=r.alias?.[t];if(n)return n;if(r.trailingSlash?.length){for(let[i,a]of r.trailingSlash)if(t.startsWith(i))return a+t.slice(i.length)}return t}#a(t){let r={};if(t.imports)for(let[n,i]of Object.entries(t.imports))!n||!er(i)||(i.endsWith("/")?(r.trailingSlash??(r.trailingSlash=[])).push([n,i]):(n==="@jsxImportSource"&&(r.jsxImportSource=i),(r.alias??(r.alias={}))[n]=i));this.#n.importMap=r}};function er(e){return typeof e=="string"&&e.length>0}function tr(e){return e.startsWith("https://")||e.startsWith("http://")}function rr({typescript:e}){return new me(e)}0&&(module.exports={init});
/*! Bundled license information:

html5parser/dist/html5parser.cjs.js:
  (*!
   *
   * Copyright 2017 - acrazing
   *
   * @author acrazing joking.young@gmail.com
   * @since 2017-08-18 15:17:51
   * @version 1.0.0
   * @desc types.ts
   *)
  (*!
   *
   * Copyright 2017 - acrazing
   *
   * @author acrazing joking.young@gmail.com
   * @since 2017-08-19 00:54:29
   * @version 1.0.0
   * @desc tokenize.ts
   *)
  (*!
   *
   * Copyright 2017 - acrazing
   *
   * @author acrazing joking.young@gmail.com
   * @since 2017-08-19 15:56:14
   * @version 1.0.0
   * @desc config.ts
   *)
  (*!
   *
   * Copyright 2017 - acrazing
   *
   * @author acrazing joking.young@gmail.com
   * @since 2017-08-20 21:41:39
   * @version 1.0.0
   * @desc utils.ts
   *)
  (*!
   *
   * Copyright 2017 - acrazing
   *
   * @author acrazing joking.young@gmail.com
   * @since 2017-08-19 00:54:46
   * @version 1.0.0
   * @desc walk.ts
   *)
  (*!
   *
   * Copyright 2017 - acrazing
   *
   * @author acrazing joking.young@gmail.com
   * @since 2017-08-19 00:54:46
   * @version 1.0.0
   * @desc parse.ts
   *)
*/
